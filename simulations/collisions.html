<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collisions | Physics for Noobs</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&family=Delius&family=Nova+Square&family=Orbitron:wght@400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&family=Andika:wght@400;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî¨</text></svg>"><circle cx='50' cy='50' r='10' fill='%2300d4ff'/><circle cx='50' cy='20' r='5' fill='%23ff2d75'/><ellipse cx='50' cy='50' rx='30' ry='15' fill='none' stroke='%2300d4ff' stroke-width='2'/><ellipse cx='50' cy='50' rx='15' ry='30' fill='none' stroke='%2300d4ff' stroke-width='2'/></svg>">

  <script src="../js/theme.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
  <script defer src="../js/firebase-config.js"></script>
  <script defer src="../js/auth.js"></script>
  <script defer src="../js/sim-tracker.js"></script>
  <link rel="stylesheet" href="../css/achievements.css">
  <script defer src="../js/achievements-config.js"></script>
  <script defer src="../js/achievements.js"></script>
</head>
<body>

  <!-- Splash Screen -->
  <div class="splash-screen" id="splash"><div class="splash-pendulum"><div class="sp-mount"></div><div class="sp-pivot"></div><div class="sp-arm"><div class="sp-rod"></div><div class="sp-bob"><div class="sp-glow"></div></div></div></div><div class="splash-logo">Physics for Noobs</div><div class="splash-tagline">Learn. Play. Master.</div></div>
<div class="bg-grid"></div>

    <nav class="navbar scrolled"><div class="nav-container"><a href="../index.html" class="nav-logo" id="nav-logo"><div class="logo-icon"><div class="logo-pendulum"><div class="pendulum-mount"></div><div class="pendulum-pivot"></div><div class="pendulum-arm"><div class="pendulum-rod"></div><div class="pendulum-bob"><div class="bob-glow"></div></div></div></div></div><div class="logo-text"><span class="brand-name">Physics for Noobs</span><span class="brand-tag">LEARN. PLAY. MASTER.</span></div></a><div class="nav-links">
        <div class="nav-item">
          <a href="../index.html" class="nav-link">Home</a>
        </div>
        <div class="nav-item">
          <a href="../about.html" class="nav-link">About Me</a>
        </div>
        <div class="nav-item"><a href="../chapters.html" class="nav-link">Chapters</a></div>        <div class="nav-item">
          <a href="../simulations.html" class="nav-link active">Simulations</a>
        </div>
        <div class="nav-item">
          <a href="../tests.html" class="nav-link">Tests</a>
        </div>
        <div class="nav-item">
          <a href="../flashcards.html" class="nav-link">Flashcards</a>
        </div>
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme"></button><button class="auth-btn" id="auth-login-btn"><svg class="google-icon" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>Sign in</button><div class="user-menu nav-item" id="auth-user-menu" style="display:none;"><img class="user-avatar" id="auth-user-avatar" src="" alt="User"><span class="user-name" id="auth-user-name"></span><div class="dropdown"><a href="../progress.html"><div class="dd-icon">&#128200;</div> My Progress</a><div class="dropdown-divider"></div><a href="#" id="auth-logout-btn"><div class="dd-icon">&#128682;</div> Sign Out</a></div></div><a href="../index.html#contact" class="nav-cta">Contact Me</a></div><button class="nav-toggle" aria-label="Menu"><span></span><span></span><span></span></button></div></nav>
  <script>
    (function(){
      var s=document.getElementById('splash');
      if(sessionStorage.getItem('ae-splash')){s.style.display='none';}
      else{
        sessionStorage.setItem('ae-splash','1');setTimeout(function(){s.classList.add('fade-out');},2200);setTimeout(function(){s.style.display='none';},2700);
      }
    })();
  </script>

    <div class="sim-page-container">

        <h1>Collisions</h1>
        <p class="subtitle">Grade XI - Work Power Energy</p>

        <div class="sim-canvas-wrapper">
            <canvas id="simulationCanvas" width="850" height="450"></canvas>

            <div class="sim-controls">
                <div class="control-group">
                    <label>Mass 1 (kg): <span id="m1Value">3.0</span></label>
                    <input type="range" id="m1Slider" min="1" max="10" value="3" step="0.1">
                </div>
                <div class="control-group">
                    <label>Mass 2 (kg): <span id="m2Value">5.0</span></label>
                    <input type="range" id="m2Slider" min="1" max="10" value="5" step="0.1">
                </div>
                <div class="control-group">
                    <label>Velocity 1 (m/s): <span id="v1Value">10.0</span></label>
                    <input type="range" id="v1Slider" min="1" max="20" value="10" step="0.1">
                </div>
                <div class="control-group">
                    <label>Velocity 2 (m/s): <span id="v2Value">0.0</span></label>
                    <input type="range" id="v2Slider" min="-10" max="10" value="0" step="0.1">
                </div>
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="elasticToggle" checked>
                        Elastic Collision
                    </label>
                </div>
                <button id="startBtn" class="control-btn">Start</button>
                <button id="resetBtn" class="control-btn">Reset</button>
            </div>
        </div>

        <div class="sim-info">
            <div class="stats-panel">
                <h3>Before Collision</h3>
                <div class="stat-item">
                    <span class="stat-label">Momentum 1:</span>
                    <span class="stat-value" id="statP1Before">30.0 kg¬∑m/s</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Momentum 2:</span>
                    <span class="stat-value" id="statP2Before">0.0 kg¬∑m/s</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total Momentum:</span>
                    <span class="stat-value" id="statPTotalBefore">30.0 kg¬∑m/s</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total KE:</span>
                    <span class="stat-value" id="statKEBefore">150.0 J</span>
                </div>

                <h3 style="margin-top: 20px;">After Collision</h3>
                <div class="stat-item">
                    <span class="stat-label">Velocity 1':</span>
                    <span class="stat-value" id="statV1After">-2.5 m/s</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Velocity 2':</span>
                    <span class="stat-value" id="statV2After">7.5 m/s</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total Momentum:</span>
                    <span class="stat-value" id="statPTotalAfter">30.0 kg¬∑m/s</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total KE:</span>
                    <span class="stat-value" id="statKEAfter">150.0 J</span>
                </div>
            </div>

            <div class="formula-box">
                <h3>Formulas</h3>
                <div class="formula-item">m‚ÇÅv‚ÇÅ + m‚ÇÇv‚ÇÇ = m‚ÇÅv‚ÇÅ' + m‚ÇÇv‚ÇÇ'</div>
                <div class="formula-item">Elastic: KE conserved</div>
                <div class="formula-item">Inelastic: v' = (m‚ÇÅv‚ÇÅ+m‚ÇÇv‚ÇÇ)/(m‚ÇÅ+m‚ÇÇ)</div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simulationCanvas');
        const ctx = canvas.getContext('2d');

        // Simulation parameters
        let m1 = 3;
        let m2 = 5;
        let v1_initial = 10;
        let v2_initial = 0;
        let isElastic = true;

        let v1_final = 0;
        let v2_final = 0;

        let ball1X = 150;
        let ball2X = 650;
        const ballY = 200;
        const trackY = 250;

        let animating = false;
        let animationPhase = 'before'; // 'before', 'colliding', 'after'
        let animationTime = 0;

        const v1 = v1_initial;
        const v2 = v2_initial;

        // Event listeners
        document.getElementById('m1Slider').addEventListener('input', (e) => {
            m1 = parseFloat(e.target.value);
            document.getElementById('m1Value').textContent = m1.toFixed(1);
            if (!animating) calculateFinalVelocities();
        });

        document.getElementById('m2Slider').addEventListener('input', (e) => {
            m2 = parseFloat(e.target.value);
            document.getElementById('m2Value').textContent = m2.toFixed(1);
            if (!animating) calculateFinalVelocities();
        });

        document.getElementById('v1Slider').addEventListener('input', (e) => {
            v1_initial = parseFloat(e.target.value);
            document.getElementById('v1Value').textContent = v1_initial.toFixed(1);
            if (!animating) calculateFinalVelocities();
        });

        document.getElementById('v2Slider').addEventListener('input', (e) => {
            v2_initial = parseFloat(e.target.value);
            document.getElementById('v2Value').textContent = v2_initial.toFixed(1);
            if (!animating) calculateFinalVelocities();
        });

        document.getElementById('elasticToggle').addEventListener('change', (e) => {
            isElastic = e.target.checked;
            if (!animating) calculateFinalVelocities();
        });

        document.getElementById('startBtn').addEventListener('click', () => {
            if (!animating) {
                animating = true;
                animationPhase = 'before';
                animationTime = 0;
                ball1X = 150;
                ball2X = 650;
                animate();
            }
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            animating = false;
            animationPhase = 'before';
            ball1X = 150;
            ball2X = 650;
            animationTime = 0;
            calculateFinalVelocities();
            draw();
        });

        function calculateFinalVelocities() {
            if (isElastic) {
                // Elastic collision formulas
                v1_final = ((m1 - m2) * v1_initial + 2 * m2 * v2_initial) / (m1 + m2);
                v2_final = (2 * m1 * v1_initial + (m2 - m1) * v2_initial) / (m1 + m2);
            } else {
                // Inelastic collision - balls stick together
                v1_final = (m1 * v1_initial + m2 * v2_initial) / (m1 + m2);
                v2_final = v1_final;
            }

            updateStats();
        }

        function updateStats() {
            const p1_before = m1 * v1_initial;
            const p2_before = m2 * v2_initial;
            const p_total_before = p1_before + p2_before;
            const ke_before = 0.5 * m1 * v1_initial * v1_initial + 0.5 * m2 * v2_initial * v2_initial;

            const p1_after = m1 * v1_final;
            const p2_after = m2 * v2_final;
            const p_total_after = p1_after + p2_after;
            const ke_after = 0.5 * m1 * v1_final * v1_final + 0.5 * m2 * v2_final * v2_final;

            document.getElementById('statP1Before').textContent = p1_before.toFixed(2) + ' kg¬∑m/s';
            document.getElementById('statP2Before').textContent = p2_before.toFixed(2) + ' kg¬∑m/s';
            document.getElementById('statPTotalBefore').textContent = p_total_before.toFixed(2) + ' kg¬∑m/s';
            document.getElementById('statKEBefore').textContent = ke_before.toFixed(2) + ' J';

            document.getElementById('statV1After').textContent = v1_final.toFixed(2) + ' m/s';
            document.getElementById('statV2After').textContent = v2_final.toFixed(2) + ' m/s';
            document.getElementById('statPTotalAfter').textContent = p_total_after.toFixed(2) + ' kg¬∑m/s';
            document.getElementById('statKEAfter').textContent = ke_after.toFixed(2) + ' J';
        }

        function drawArrow(x, y, velocity, color, label) {
            const length = Math.abs(velocity) * 10;
            const direction = velocity >= 0 ? 1 : -1;

            ctx.strokeStyle = color;
            ctx.fillStyle = color;
            ctx.lineWidth = 2;

            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + length * direction, y);
            ctx.stroke();

            if (length > 0) {
                ctx.beginPath();
                ctx.moveTo(x + length * direction, y);
                ctx.lineTo(x + length * direction - 8 * direction, y - 5);
                ctx.lineTo(x + length * direction - 8 * direction, y + 5);
                ctx.closePath();
                ctx.fill();
            }

            ctx.font = '12px JetBrains Mono';
            ctx.fillText(label, x + length * direction / 2 - 10, y - 10);
        }

        function drawBall(x, y, mass, color, label) {
            const radius = 15 + mass * 3;

            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.fill();

            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.stroke();

            ctx.fillStyle = '#ffffff';
            ctx.font = '14px JetBrains Mono';
            ctx.textAlign = 'center';
            ctx.fillText(label, x, y + 5);
        }

        function drawBarChart(x, y, p1_before, p2_before, p1_after, p2_after) {
            const barWidth = 40;
            const maxHeight = 100;
            const maxP = Math.max(Math.abs(p1_before), Math.abs(p2_before), Math.abs(p1_after), Math.abs(p2_after), 1);

            ctx.font = '12px JetBrains Mono';
            ctx.fillStyle = '#00d4ff';
            ctx.fillText('Momentum (kg¬∑m/s)', x, y - 110);

            // Before collision
            const h1b = (Math.abs(p1_before) / maxP) * maxHeight;
            const h2b = (Math.abs(p2_before) / maxP) * maxHeight;

            ctx.fillStyle = '#00d4ff';
            ctx.fillRect(x, y - h1b, barWidth, h1b);
            ctx.fillStyle = '#ff2d75';
            ctx.fillRect(x + barWidth + 5, y - h2b, barWidth, h2b);

            ctx.fillStyle = '#ffffff';
            ctx.font = '10px JetBrains Mono';
            ctx.fillText(p1_before.toFixed(1), x + barWidth/2, y + 15);
            ctx.fillText(p2_before.toFixed(1), x + barWidth + 5 + barWidth/2, y + 15);

            // After collision
            const h1a = (Math.abs(p1_after) / maxP) * maxHeight;
            const h2a = (Math.abs(p2_after) / maxP) * maxHeight;

            ctx.fillStyle = 'rgba(0, 212, 255, 0.5)';
            ctx.fillRect(x + 100, y - h1a, barWidth, h1a);
            ctx.fillStyle = 'rgba(255, 45, 117, 0.5)';
            ctx.fillRect(x + 145, y - h2a, barWidth, h2a);

            ctx.fillStyle = '#ffffff';
            ctx.fillText(p1_after.toFixed(1), x + 100 + barWidth/2, y + 15);
            ctx.fillText(p2_after.toFixed(1), x + 145 + barWidth/2, y + 15);

            ctx.fillStyle = '#00ffaa';
            ctx.fillText('Before', x + 40, y + 30);
            ctx.fillText('After', x + 120, y + 30);
        }

        function draw() {
            ctx.fillStyle = '#080818';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw track
            ctx.strokeStyle = '#00d4ff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(50, trackY);
            ctx.lineTo(800, trackY);
            ctx.stroke();

            // Draw balls
            drawBall(ball1X, ballY, m1, '#00d4ff', 'm‚ÇÅ');
            drawBall(ball2X, ballY, m2, '#ff2d75', 'm‚ÇÇ');

            // Draw velocity arrows
            if (animationPhase === 'before') {
                drawArrow(ball1X, ballY - 40, v1_initial, '#00ffaa', 'v‚ÇÅ');
                drawArrow(ball2X, ballY - 40, v2_initial, '#00ffaa', 'v‚ÇÇ');
            } else if (animationPhase === 'after') {
                drawArrow(ball1X, ballY - 40, v1_final, '#f59e0b', "v‚ÇÅ'");
                if (!isElastic || Math.abs(ball1X - ball2X) > 5) {
                    drawArrow(ball2X, ballY - 40, v2_final, '#f59e0b', "v‚ÇÇ'");
                }
            }

            // Draw bar chart
            const p1_before = m1 * v1_initial;
            const p2_before = m2 * v2_initial;
            const p1_after = m1 * v1_final;
            const p2_after = m2 * v2_final;
            drawBarChart(600, 400, p1_before, p2_before, p1_after, p2_after);

            // Draw phase indicator
            ctx.fillStyle = '#00d4ff';
            ctx.font = '16px JetBrains Mono';
            ctx.fillText('Phase: ' + animationPhase.toUpperCase(), 50, 50);
            ctx.fillText('Type: ' + (isElastic ? 'ELASTIC' : 'INELASTIC'), 50, 75);
        }

        function animate() {
            if (!animating) return;

            const dt = 0.5;

            if (animationPhase === 'before') {
                ball1X += v1_initial * dt;
                ball2X += v2_initial * dt;

                if (Math.abs(ball1X - ball2X) <= 50) {
                    animationPhase = 'colliding';
                    animationTime = 0;
                }
            } else if (animationPhase === 'colliding') {
                animationTime += dt;
                if (animationTime > 20) {
                    animationPhase = 'after';
                }
            } else if (animationPhase === 'after') {
                ball1X += v1_final * dt;
                if (isElastic) {
                    ball2X += v2_final * dt;
                } else {
                    ball2X = ball1X;
                }

                if (ball1X < 0 || ball1X > 850 || ball2X < 0 || ball2X > 850) {
                    animating = false;
                }
            }

            draw();

            if (animating) {
                requestAnimationFrame(animate);
            }
        }

        // Initialize
        calculateFinalVelocities();
        draw();
    </script>

    <script src="../js/main.js"></script>
</body>
</html>
